/**
 * 主题包
 *
 * */

let DX = {
  "color": [
    "#c12e34",
    "#e6b600",
    "#0098d9",
    "#2b821d",
    "#005eaa",
    "#339ca8",
    "#cda819",
    "#32a487",

    'rgb(163,231,3)',
    'rgb(20,194,81)',
    'rgb(0,228,255)',
    'rgb(1,137,255)',
    'rgb(95,5,215)',

    'rgb(49,83,23)',
    'rgb(7,73,46)',
    'rgb(2,84,99)',
    'rgb(0,59,102)',
    'rgb(29,16,88)',

  ],
  "backgroundColor": "rgba(0,0,0,0)",
  "textStyle": {},
  "title": {
    "textStyle": {
      "color": "#333333"
    },
    "subtextStyle": {
      "color": "#aaaaaa"
    }
  },
  "line": {
    "itemStyle": {
      "normal": {
        "borderWidth": 1
      }
    },
    "lineStyle": {
      "normal": {
        "width": 2
      }
    },
    "symbolSize": 4,
    "symbol": "emptyCircle",
    "smooth": false
  },
  "radar": {
    "itemStyle": {
      "normal": {
        "borderWidth": 1
      }
    },
    "lineStyle": {
      "normal": {
        "width": 2
      }
    },
    "symbolSize": 4,
    "symbol": "emptyCircle",
    "smooth": false
  },
  "bar": {
    "itemStyle": {
      "normal": {
        "barBorderWidth": 0,
        "barBorderColor": "#ccc"
      },
      "emphasis": {
        "barBorderWidth": 0,
        "barBorderColor": "#ccc"
      }
    }
  },
  "pie": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      },
      "emphasis": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    }
  },
  "scatter": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      },
      "emphasis": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    }
  },
  "boxplot": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      },
      "emphasis": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    }
  },
  "parallel": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      },
      "emphasis": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    }
  },
  "sankey": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      },
      "emphasis": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    }
  },
  "funnel": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      },
      "emphasis": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    }
  },
  "gauge": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      },
      "emphasis": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    }
  },
  "candlestick": {
    "itemStyle": {
      "normal": {
        "color": "#c12e34",
        "color0": "#2b821d",
        "borderColor": "#c12e34",
        "borderColor0": "#2b821d",
        "borderWidth": 1
      }
    }
  },
  "graph": {
    "itemStyle": {
      "normal": {
        "borderWidth": 0,
        "borderColor": "#ccc"
      }
    },
    "lineStyle": {
      "normal": {
        "width": 1,
        "color": "#aaaaaa"
      }
    },
    "symbolSize": 4,
    "symbol": "emptyCircle",
    "smooth": false,
    "color": [
      "#c12e34",
      "#e6b600",
      "#0098d9",
      "#2b821d",
      "#005eaa",
      "#339ca8",
      "#cda819",
      "#32a487"
    ],
    "label": {
      "normal": {
        "textStyle": {
          "color": "#eeeeee"
        }
      }
    }
  },
  "map": {
    "itemStyle": {
      "normal": {
        "areaColor": "#dddddd",
        "borderColor": "#eeeeee",
        "borderWidth": 0.5
      },
      "emphasis": {
        "areaColor": "rgba(230,182,0,1)",
        "borderColor": "#dddddd",
        "borderWidth": 1
      }
    },
    "label": {
      "normal": {
        "textStyle": {
          "color": "#c12e34"
        }
      },
      "emphasis": {
        "textStyle": {
          "color": "rgb(193,46,52)"
        }
      }
    }
  },
  "geo": {
    "itemStyle": {
      "normal": {
        "areaColor": "#dddddd",
        "borderColor": "#eeeeee",
        "borderWidth": 0.5
      },
      "emphasis": {
        "areaColor": "rgba(230,182,0,1)",
        "borderColor": "#dddddd",
        "borderWidth": 1
      }
    },
    "label": {
      "normal": {
        "textStyle": {
          "color": "#c12e34"
        }
      },
      "emphasis": {
        "textStyle": {
          "color": "rgb(193,46,52)"
        }
      }
    }
  },
  "categoryAxis": {
    "axisLine": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisTick": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisLabel": {
      "show": true,
      "textStyle": {
        "color": "#333"
      }
    },
    "splitLine": {
      "show": false,
      "lineStyle": {
        "color": [
          "#ccc"
        ]
      }
    },
    "splitArea": {
      "show": false,
      "areaStyle": {
        "color": [
          "rgba(250,250,250,0.3)",
          "rgba(200,200,200,0.3)"
        ]
      }
    }
  },
  "valueAxis": {
    "axisLine": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisTick": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisLabel": {
      "show": true,
      "textStyle": {
        "color": "#333"
      }
    },
    "splitLine": {
      "show": true,
      "lineStyle": {
        "color": [
          "#ccc"
        ]
      }
    },
    "splitArea": {
      "show": false,
      "areaStyle": {
        "color": [
          "rgba(250,250,250,0.3)",
          "rgba(200,200,200,0.3)"
        ]
      }
    }
  },
  "logAxis": {
    "axisLine": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisTick": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisLabel": {
      "show": true,
      "textStyle": {
        "color": "#333"
      }
    },
    "splitLine": {
      "show": true,
      "lineStyle": {
        "color": [
          "#ccc"
        ]
      }
    },
    "splitArea": {
      "show": false,
      "areaStyle": {
        "color": [
          "rgba(250,250,250,0.3)",
          "rgba(200,200,200,0.3)"
        ]
      }
    }
  },
  "timeAxis": {
    "axisLine": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisTick": {
      "show": true,
      "lineStyle": {
        "color": "#333"
      }
    },
    "axisLabel": {
      "show": true,
      "textStyle": {
        "color": "#333"
      }
    },
    "splitLine": {
      "show": true,
      "lineStyle": {
        "color": [
          "#ccc"
        ]
      }
    },
    "splitArea": {
      "show": false,
      "areaStyle": {
        "color": [
          "rgba(250,250,250,0.3)",
          "rgba(200,200,200,0.3)"
        ]
      }
    }
  },
  "toolbox": {
    "iconStyle": {
      "normal": {
        "borderColor": "#06467c"
      },
      "emphasis": {
        "borderColor": "#4187c2"
      }
    }
  },
  "legend": {
    "textStyle": {
      "color": "white"
    }
  },
  "tooltip": {
    "axisPointer": {
      "lineStyle": {
        "color": "#cccccc",
        "width": 1
      },
      "crossStyle": {
        "color": "#cccccc",
        "width": 1
      }
    }
  },
  "timeline": {
    "lineStyle": {
      "color": "#005eaa",
      "width": 1
    },
    "itemStyle": {
      "normal": {
        "color": "#005eaa",
        "borderWidth": 1
      },
      "emphasis": {
        "color": "#005eaa"
      }
    },
    "controlStyle": {
      "normal": {
        "color": "#005eaa",
        "borderColor": "#005eaa",
        "borderWidth": 0.5
      },
      "emphasis": {
        "color": "#005eaa",
        "borderColor": "#005eaa",
        "borderWidth": 0.5
      }
    },
    "checkpointStyle": {
      "color": "#005eaa",
      "borderColor": "rgba(49,107,194,0.5)"
    },
    "label": {
      "normal": {
        "textStyle": {
          "color": "#005eaa"
        }
      },
      "emphasis": {
        "textStyle": {
          "color": "#005eaa"
        }
      }
    }
  },
  "visualMap": {
    "color": [
      "#1790cf",
      "#a2d4e6"
    ]
  },
  "dataZoom": {
    "backgroundColor": "rgba(47,69,84,0)",
    "dataBackgroundColor": "rgba(47,69,84,0.3)",
    "fillerColor": "rgba(167,183,204,0.4)",
    "handleColor": "#a7b7cc",
    "handleSize": "100%",
    "textStyle": {
      "color": "#333333"
    }
  },
  "markPoint": {
    "label": {
      "normal": {
        "textStyle": {
          "color": "#eeeeee"
        }
      },
      "emphasis": {
        "textStyle": {
          "color": "#eeeeee"
        }
      }
    }
  }
}
echarts.registerTheme('DX', DX)

import { recursionObject } from '../../../../utils/validate'

let initLine = function () {
  return {
    legend:{
      // textStyle:{
      //   color:'white'
      // }
      top:'bottom',
      itemGap:2
    },
    grid:{
      left:'10%',
      top:'10%',
      bottom:'18%',
      containLabel:true
    },
    tooltip:{
      confine:true,
      trigger:'axis',
      axisPointer : {            // 坐标轴指示器，坐标轴触发有效
        type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
      }
    },
    xAxis: {
      type: 'category',
      data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
      // name:'时间',
      nameGap: 2,
      nameTextStyle: {
        color: 'white'
      },
      // data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
      axisTick: {
        show: false
      },
      axisLine: {
        lineStyle: {
          color: 'rgb(74,85,177)'
        }
      },
      axisLabel: {
        color: 'white',
        interval:0
      }
    },
    yAxis: [
      {
        type: 'value',
        // name:'个',
        nameTextStyle: {
          color: 'white'
        },
        splitLine: {
          show:false,
          lineStyle: {
            color: 'rgb(1,41,91)'
          }
        },
        axisTick: {
          show: false
        },
        axisLine: {show: false},
        axisLabel: {
          color: 'white'
        },
        minInterval:1
      }
    ],
    series: [
      {
        name:'序列一',
        type: 'line',
        data:[{name:'Mon',value:820},{name:'Tue',value:820},{name:'Wed',value:820}],
        smooth: true
      },
      {
        name:'序列二',
        type: 'line',
        data:[{name:'Mon',value:82},{name:'Tue',value:82},{name:'Wed',value:82}],
        smooth: true
      }
    ]
  }
}
/**
 * {
    "id":"",
    "xAxis":{
      "name":""
    },
    "yAxis":{
      "name":""
    },
    "data":[
      {
        "name":"序列一",
        "type": "line",
        "data":[{"name":"Mon","value":820},{"name":"Tue","value":820},{"name":"Wed","value":820}],
        "smooth": true
      },
      {
        "name":"序列二",
        "type": "line",
        "data":[{"name":"Mon","value":82},{"name":"Tue","value":82},{"name":"Wed","value":82}],
        "smooth": true
      }
    ]
  }
 *
 */
export function showLineCharts(data,myChart){
  // console.log(data)
  if(!myChart){
    let line = new initLine()

    let temp = {}
    for(let i in data){
      if(i !== 'data'){
        temp[i] = data[i]
      }
    }

    line = recursionObject(line,temp)

    myChart = echarts.init(document.getElementById(data.id),'DX')
    if(data.xAxis && data.xAxis.name){
      line.xAxis.name = data.xAxis.name
    }
    if(data.yAxis && data.yAxis.name){
      line.yAxis.name = data.yAxis.name
    }
    line.xAxis.data = []
    for(let i = 0,j = data.data[0].data.length;i<j;i+=1){
      line.xAxis.data.push(data.data[0].data[i].name)
    }
    line.series = []
    for(let i = 0,j = data.data.length;i<j;i+=1){
      if(!data.data[i].type || data.data[i].type === 'line'){
        data.data[i].type = 'line'
        // data.data[i].symbolSize = 7
        // data.data[i].symbol = 'circle'
        data.data[i].itemStyle = {
          // color: data.data[index].color !== undefined?data.data[index].color:'rgb(0,119,225)'
          color:data.color!==undefined&&data.color.length>i?data.color[i]:DX.color[(i)%(DX.color.length)]
        }
        data.data[i].areaStyle = {
          color: {
            type: 'line',
              x: 0,
              y: 0,
              x2: 0,
              y2: 1,
              colorStops: [{
              // offset: 0, color: data.data[index].color !== undefined?data.data[index].color:'rgb(0,119,225)' // 0% 处的颜色
              offset: 0, color: data.color!==undefined&&data.color.length>i?data.color[i]:DX.color[(i)%(DX.color.length)] // 0% 处的颜色
            }, {
              offset: 1, color: 'transparent' // 100% 处的颜色
            }],
              globalCoord: false // 缺省为 false
          }
        }
      }else {
        data.data[i].type = 'bar'
        // data.data[i].itemStyle = {
        //   normal: {
        //     color: new echarts.graphic.LinearGradient(
        //       0, 0, 0, 1,
        //       [
        //         // {offset: 0.7, color: data.data[index].color !== undefined?data.data[index].color:'rgb(0,198,238)'},
        //         {offset: 0.7, color: DX.color[(i)%(DX.color.length)]},
        //         // {offset: 0.5, color: '#188df0'},
        //         {offset: 1, color: 'transparent'}
        //       ]
        //     ),
        //       barBorderRadius:[20,20,0,0],
        //       barWidth:10
        //   },
        //   emphasis: {
        //     color: new echarts.graphic.LinearGradient(
        //       0, 0, 0, 1,
        //       [
        //         {offset: 0.7, color: DX.color[(i)%(DX.color.length)]},
        //         {offset: 1, color: 'transparent'}
        //       ]
        //     )
        //   }
        // }
      }
      data.data[i].smooth = true
      line.series.push(data.data[i])
    }
    myChart.setOption(line)
    myChart.resize()
    return myChart
  }else {
    let line = {
      xAxis:{
        name:'',
        data:[]
      },
      yAxis:{
        name:''
      },
      series:[]
    }
    if(data.xAxis && data.xAxis.name){
      line.xAxis.name = data.xAxis.name
    }
    if(data.yAxis && data.yAxis.name){
      line.yAxis.name = data.yAxis.name
    }
    for(let i = 0,j = data.data[0].data.length;i<j;i+=1){
      line.xAxis.data.push(data.data[0].data[i].name)
    }
    for(let i = 0,j = data.data.length;i<j;i+=1){
      data.data[i].type = 'line'
      line.series.push(data.data[i])
    }
    myChart.setOption({
      xAxis:{
        name:line.xAxis.name,
        data:line.xAxis.data
      },
      yAxis:{
        name:line.yAxis.name
      },
      series:line.series
    })
    return myChart
  }
}

let initPie = function () {
  let option = {
    tooltip : {
      trigger: 'item',
      formatter: "{a} <br/>{b} : {c} ({d}%)",
      confine:true
    },
    legend:{
      // orient:'vertical',
      // left:'right',
      top:'bottom',
      itemGap:2
    },
    series : [
      {
        name:'访问来源',
        type:'pie',
        center: ['50%', '50%'],
        radius: ['15%', '60%'],
        data:[
          {value:335, name:'直接访问'},
          {value:310, name:'邮件营销'},
          {value:274, name:'联盟广告'},
          {value:235, name:'视频广告'},
          {value:400, name:'搜索引擎'}
        ].sort(function (a, b) { return a.value - b.value; }),
        roseType: 'radius',
        label: {
          formatter:function(a,b,c,d){
            let temp = a.name.split('')
            for(let i = 0,j = a.name.split('').length;i<j;i+=1){
              if(i%6===0&&i!==0){
                temp.splice(i,0,'\n')
              }
            }
            return a.name.length>7?temp.join(''):a.name
          }
        },
        labelLine: {
          normal: {
            lineStyle: {
              // color: 'rgba(255, 255, 255, 0.3)'
            },
            smooth: 0.2,
            length: 5,
            length2: 10
          }
        },
        animationType: 'scale',
        animationEasing: 'elasticOut'
      }
    ]
  }
  return option
}
/**
 *
 * {
    data : [
      {
        name:'访问来源',
        data:[
          {value:335, name:'直接访问'},
          {value:310, name:'邮件营销'},
          {value:274, name:'联盟广告'},
          {value:235, name:'视频广告'},
          {value:400, name:'搜索引擎'}
        ]
      }
    ]
  }
 */
export function showPieCharts(data,myChart) {

  // console.log(data)

  if(!myChart){
    let pie = new initPie()

    let temp = {}
    for(let i in data){
      if(i !== 'data'){
        temp[i] = data[i]
      }
    }

    pie = recursionObject(pie,temp)

    myChart = echarts.init(document.getElementById(data.id),'DX')
    let series = pie.series[0]
    let seriesArray = []
    for(let i = 0,j = data.data.length;i<j;i+=1){
      // series.name = data.data[i].name
      // series.data = data.data[i].data
      // if(data.data[i].center === undefined){
      //   series.center = [(1/(j+1)*(i+1))*100+'%', '50%']
      // }else {
      //   series.center = data.data[i].center
      // }
      for(let a in series){
        if(data.data[i][a] !== undefined){
          series[a] = data.data[i][a]
        }
      }
      if(data.data[i].center === undefined){
        series.center = [(1/(j+1)*(i+1))*100+'%', '50%']
      }else {
        series.center = data.data[i].center
      }
      seriesArray.push(series)
    }
    pie.series = seriesArray
    myChart.setOption(pie)
    myChart.resize()
    console.log(pie)
    return myChart
  }else {
    let series = {
      name:'',
      data:[],
      center:[]
    }
    let seriesArray = []
    for(let i = 0,j = data.data.length;i<j;i+=1){
      series.name = data.data[i].name
      series.data = data.data[i].data
      series.center = [(1/(j+1)*(i+1))*100+'%',(1/(j%2+1))*(i%2+1)*100+ '%']
      seriesArray.push(series)
    }
    myChart.setOption(series)
    return myChart
  }
}

export function showFunnel(data) {
  let option = {
    tooltip: {
      trigger: 'item',
      formatter: "{a} <br/>{b} : {c}"
    },
    legend: {
      show:false,
      bottom:'bottom'
    },
    series: [
      {
        name: '预期',
        type: 'funnel',
        left: '0%',
        width: '100%',
        label: {
          normal: {
            formatter: '{b}'
          },
          emphasis: {
            position:'inside',
            formatter: '{b}: {c}'
          }
        },
        labelLine: {
          normal: {
            show: false
          }
        },
        itemStyle: {
          normal: {
            opacity: 0.7
          }
        },
        data: [
          {value: 60, name: '访问'},
          {value: 40, name: '咨询'},
          {value: 20, name: '订单'},
          {value: 80, name: '点击'},
          {value: 100, name: '展现'}
        ]
      },
      {
        name: '实际',
        type: 'funnel',
        left: '10%',
        width: '80%',
        label: {
          normal: {
            position: 'inside',
            formatter: '{c}',
            textStyle: {
              color: '#fff'
            }
          },
          emphasis: {
            position:'inside',
            formatter: '{b}: {c}'
          }
        },
        itemStyle: {
          normal: {
            opacity: 0.5,
            borderColor: '#fff',
            borderWidth: 2
          }
        },
        data: [
          {value: 30, name: '访问'},
          {value: 10, name: '咨询'},
          {value: 5, name: '订单'},
          {value: 50, name: '点击'},
          {value: 80, name: '展现'}
        ]
      }
    ]
  }
  let myChart = echarts.init(document.getElementById(data.id),'DX')
  option.series = data.data
  myChart.setOption(option)
  myChart.resize()
}
